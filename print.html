<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>algorithm blog</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">algorithm blog</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="ç®—æ³•å­¦ä¹ æµç¨‹"><a class="header" href="#ç®—æ³•å­¦ä¹ æµç¨‹">ç®—æ³•å­¦ä¹ æµç¨‹</a></h1>
<h2 id="part1åŸºç¡€ç®—æ³•"><a class="header" href="#part1åŸºç¡€ç®—æ³•">part1.åŸºç¡€ç®—æ³•</a></h2>
<ol>
<li>bfs/dfsæš´åŠ›æœç´¢ï¼ˆèµ°è¿·å®«ï¼‰</li>
<li>å‰ç¼€å’Œ/å·®åˆ†ï¼ˆå¿«é€Ÿæ±‚å’Œï¼‰</li>
<li>å•è°ƒæ ˆ/å•è°ƒé˜Ÿåˆ—</li>
<li>å¹¶æŸ¥é›†</li>
<li>kmp/exkmp/manacherï¼ˆåŸºç¡€å­—ç¬¦ä¸²å¤„ç†ï¼‰</li>
<li>å¿«é€Ÿå¹‚</li>
</ol>
<h2 id="part2åŸºç¡€ç®—æ³•æå‡"><a class="header" href="#part2åŸºç¡€ç®—æ³•æå‡">part2.åŸºç¡€ç®—æ³•æå‡</a></h2>
<ol>
<li>äºŒåˆ†æå‡ï¼ˆäºŒåˆ†ç»“æœ/å‚æ•°ï¼‰</li>
<li>çŸ©é˜µä¹˜æ³•ä¸å¿«é€Ÿå¹‚</li>
<li>bfs/dfsï¼ˆæ¯”è¾ƒå¤æ‚çš„è¿·å®«ï¼‰</li>
<li>é«˜æ–¯æ¶ˆå…ƒï¼ˆä½è¿ç®—çº¿æ€§åŸºï¼‰</li>
</ol>
<h2 id="part3åŠ¨æ€è§„åˆ’"><a class="header" href="#part3åŠ¨æ€è§„åˆ’">part3.åŠ¨æ€è§„åˆ’</a></h2>
<h3 id="èƒŒåŒ…å®¶æ—"><a class="header" href="#èƒŒåŒ…å®¶æ—">èƒŒåŒ…å®¶æ—</a></h3>
<ol>
<li>01èƒŒåŒ…</li>
<li>å®Œå…¨èƒŒåŒ…</li>
<li>åˆ†ç»„èƒŒåŒ…</li>
<li>å¤šé‡èƒŒåŒ…ï¼ˆäºŒè¿›åˆ¶ä¼˜åŒ–ï¼Œå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ï¼‰</li>
</ol>
<h3 id="å­åºåˆ—é—®é¢˜"><a class="header" href="#å­åºåˆ—é—®é¢˜">å­åºåˆ—é—®é¢˜</a></h3>
<ol>
<li>æœ€é•¿å…¬å…±å­åºåˆ—</li>
<li>åˆæ³•å­åºåˆ—æ•°é‡</li>
</ol>
<h3 id="åˆ’åˆ†é—®é¢˜"><a class="header" href="#åˆ’åˆ†é—®é¢˜">åˆ’åˆ†é—®é¢˜</a></h3>
<ol>
<li>æœ€ä¼˜åˆ’åˆ†</li>
<li>çº¦æŸåˆ’åˆ†ä¸ªæ•°ï¼ˆåˆ’åˆ†ä¸ºkä¸ªï¼‰</li>
</ol>
<h3 id="çŠ¶æ€æœº"><a class="header" href="#çŠ¶æ€æœº">çŠ¶æ€æœº</a></h3>
<ol>
<li>ä¹°å–è‚¡ç¥¨çŠ¶æ€æœºï¼ˆå†³ç­–æœ‰åæœï¼‰</li>
</ol>
<h3 id="æ ‘ä¸ŠèƒŒåŒ…ç»¼åˆè¿ç”¨ä¸Šæ–¹é—®é¢˜"><a class="header" href="#æ ‘ä¸ŠèƒŒåŒ…ç»¼åˆè¿ç”¨ä¸Šæ–¹é—®é¢˜">æ ‘ä¸ŠèƒŒåŒ…ï¼ˆç»¼åˆè¿ç”¨ä¸Šæ–¹é—®é¢˜ï¼‰</a></h3>
<ol>
<li>æ ‘ä¸Šæœ€å¤§ç‹¬ç«‹é›†ï¼ˆæ²¡æœ‰ä¸Šå¸çš„èˆä¼šï¼‰ï¼ˆä¸çŠ¶æ€æœºç›¸å…³ï¼‰</li>
<li>æ ‘ä¸ŠèƒŒåŒ…ï¼ˆdfs+çº¦æŸåˆ’åˆ†ä¸ªæ•°+çŠ¶æ€æœºï¼‰</li>
</ol>
<h3 id="çŠ¶æ€å‹ç¼©dp"><a class="header" href="#çŠ¶æ€å‹ç¼©dp">çŠ¶æ€å‹ç¼©dp</a></h3>
<h3 id="æ•°ä½dp"><a class="header" href="#æ•°ä½dp">æ•°ä½dp</a></h3>
<h2 id="part4å›¾è®ºå®¶æ—"><a class="header" href="#part4å›¾è®ºå®¶æ—">part4.å›¾è®ºå®¶æ—</a></h2>
<ol>
<li>å›¾çš„åŸºç¡€è¡¨ç¤ºå’Œéå†ï¼ˆDFSã€BFSï¼‰</li>
<li>æœ€çŸ­è·¯å¾„ç®—æ³•ï¼ˆDijkstraã€Bellman-Fordã€SPFAã€Floydï¼‰</li>
<li>æœ€å°ç”Ÿæˆæ ‘ï¼ˆPrimã€Kruskalï¼‰</li>
<li>æ‹“æ‰‘æ’åº</li>
<li>æ¬§æ‹‰è·¯å¾„ä¸å›è·¯</li>
<li>å¼ºè¿é€šåˆ†é‡ï¼ˆKosarajuã€Tarjanï¼‰</li>
<li>äºŒåˆ†å›¾åŒ¹é…ï¼ˆåŒˆç‰™åˆ©ç®—æ³•ã€äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ã€æœ€å°ç‚¹è¦†ç›–ã€æœ€å¤§ç‹¬ç«‹é›†ç­‰ï¼‰</li>
<li>ç½‘ç»œæµï¼ˆæœ€å¤§æµã€æœ€å°å‰²ã€è´¹ç”¨æµï¼‰</li>
</ol>
<h2 id="part5æ•°è®º"><a class="header" href="#part5æ•°è®º">part5.æ•°è®º</a></h2>
<p>ï¼ˆå¾…å¡«å…¥å†…å®¹ï¼‰</p>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="èƒŒåŒ…é—®é¢˜ç®—æ³•è®²è§£"><a class="header" href="#èƒŒåŒ…é—®é¢˜ç®—æ³•è®²è§£">èƒŒåŒ…é—®é¢˜ç®—æ³•è®²è§£</a></h1>
<h2 id="01èƒŒåŒ…é—®é¢˜"><a class="header" href="#01èƒŒåŒ…é—®é¢˜">01èƒŒåŒ…é—®é¢˜</a></h2>
<p>01èƒŒåŒ…é—®é¢˜æ˜¯æœ€åŸºç¡€çš„èƒŒåŒ…é—®é¢˜ï¼Œç‰¹ç‚¹æ˜¯æ¯ç§ç‰©å“åªæœ‰ä¸€ä»¶ã€‚
åœ¨å¤„ç†æ¯ä¸€ä»¶ç‰©å“çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ç§è€ƒè™‘çš„æ–¹æ¡ˆ--é€‰æ‹©è¿™ä»¶ç‰©å“æˆ–è€…ä¸é€‰æ‹©ã€‚
å¦‚æœæˆ‘ä»¬é€‰æ‹©è¿™ç§ç‰©å“æ¶ˆè€—<code>c[i]</code>çš„èµ„æºï¼Œå¾—åˆ°<code>v[i]</code>çš„æ”¶ç›Š
å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬<code>é¢å¯¹ç¬¬iä¸ªç‰©å“ï¼Œæ‹¥æœ‰jçš„èµ„æºçš„æ—¶å€™</code>ï¼Œä¾¿å¯ä»¥å°†é—®é¢˜è½¬åŒ–ä¸º
æˆ‘åœ¨<code>ä¸ä¹°è¿™ä¸ªç‰©å“</code>å’Œ<code>ä¹°ä¸‹è¿™ä¸ªç‰©å“</code>å“ªç§é€‰æ‹©çš„æ”¶ç›Šæ›´é«˜
å¦‚æœæˆ‘ä»¬ä»¥<code>dp[i][j]</code>è¡¨ç¤ºä¸Šè¿°çš„<code>"é¢å¯¹ç¬¬iä¸ªç‰©å“ï¼Œæ‹¥æœ‰jçš„èµ„æºçš„æ—¶å€™"</code>æ—¶èƒ½å¾—åˆ°çš„æœ€å¤§æ”¶ç›Š
é‚£è¿™ä¸ª<code>dp[i][j]</code>å°±å¯ä»¥è¢«è½¬åŒ–ä¸ºåœ¨<code>dp[i-1][j]</code>ä¸<code>dp[i-1][j-c[i]]+v[i]</code>ä¸­é€‰æ‹©è¾ƒå¤§é‚£ä¸ª
å› æ­¤ï¼ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹å³ä¸º
<code>dp[i+1][j] = max(dp[i][j],dp[i][j-c[i]]+v[i])</code></p>
<h3 id="ä»£ç è§£æ"><a class="header" href="#ä»£ç è§£æ">ä»£ç è§£æ</a></h3>
<p>(ä¸‹é¢çš„ä»£ç æˆ‘ç›´æ¥ä½¿ç”¨äº†æ»šåŠ¨æ•°ç»„ä¼˜åŒ–)</p>
<pre><code class="language-c++">vector&lt;int&gt; dp(t+1); 
// åˆ›å»ºåŠ¨æ€è§„åˆ’æ•°ç»„ï¼Œ
// dp[j]è¡¨ç¤ºå®¹é‡ä¸ºjæ—¶çš„æœ€å¤§ä»·å€¼
for(int i=0;i&lt;m;++i){ // éå†æ‰€æœ‰ç‰©å“
    for(int j=t;j&gt;=cost[i];--j){ 
        // ä»å¤§åˆ°å°éå†èƒŒåŒ…å®¹é‡
        dp[j]=max(dp[j],dp[j-cost[i]]+value[i]); 
        // çŠ¶æ€è½¬ç§»æ–¹ç¨‹
    }
}
</code></pre>
<h3 id="å…³é”®ç‚¹"><a class="header" href="#å…³é”®ç‚¹">å…³é”®ç‚¹</a></h3>
<ol>
<li><strong>çŠ¶æ€å®šä¹‰</strong>ï¼š<code>dp[j]</code>è¡¨ç¤ºèƒŒåŒ…å®¹é‡ä¸ºjæ—¶èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼</li>
<li><strong>çŠ¶æ€è½¬ç§»</strong>ï¼šå¯¹äºæ¯ä¸ªç‰©å“ï¼Œè€ƒè™‘æ”¾å…¥æˆ–ä¸æ”¾å…¥ä¸¤ç§æƒ…å†µ</li>
<li><strong>é€†åºéå†</strong>ï¼šå¿…é¡»ä»å¤§åˆ°å°éå†èƒŒåŒ…å®¹é‡ï¼Œç¡®ä¿æ¯ä¸ªç‰©å“åªè¢«ä½¿ç”¨ä¸€æ¬¡
ä¸‹é¢ç»™å‡ºâ€œå®Œå…¨èƒŒåŒ…â€éƒ¨åˆ†çš„å®Œæ•´å±•å¼€ï¼Œå®Œå…¨å¯¹æ ‡ä½ å·²æœ‰çš„â€œ01èƒŒåŒ…â€å†™æ³•ã€‚ä½ å¯ä»¥ç›´æ¥æ›¿æ¢æˆ–åˆå¹¶åˆ°åŸç¬”è®°ä¸­ï¼Œä¿æŒé£æ ¼ä¸€è‡´ã€‚</li>
</ol>
<hr />
<h2 id="å®Œå…¨èƒŒåŒ…é—®é¢˜"><a class="header" href="#å®Œå…¨èƒŒåŒ…é—®é¢˜">å®Œå…¨èƒŒåŒ…é—®é¢˜</a></h2>
<p>å®Œå…¨èƒŒåŒ…é—®é¢˜åœ¨01èƒŒåŒ…çš„åŸºç¡€ä¸Šï¼ŒæŠŠã€Œæ¯ç§ç‰©å“åªæœ‰1ä»¶ã€æ”¾å®½ä¸ºã€Œæ¯ç§ç‰©å“æœ‰âˆä»¶ã€ã€‚<br />
å› æ­¤ï¼Œå½“æˆ‘ä»¬<strong>é¢å¯¹ç¬¬iä¸ªç‰©å“ã€æ‹¥æœ‰jçš„èµ„æºæ—¶</strong>ï¼Œå†³ç­–ä¸å†æ˜¯â€œæ‹¿æˆ–ä¸æ‹¿â€ï¼Œè€Œæ˜¯**â€œæ‹¿0ä»¶ã€æ‹¿1ä»¶ã€æ‹¿2ä»¶â€¦â€¦ç›´åˆ°èƒŒåŒ…æ”¾ä¸ä¸‹â€**ã€‚<br />
å¦‚æœæˆ‘ä»¬æ²¿ç”¨<code>dp[i][j]</code>è¡¨ç¤ºâ€œä»…è€ƒè™‘å‰iç§ç‰©å“ã€èƒŒåŒ…å®¹é‡ä¸ºjæ—¶èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼â€ï¼Œé‚£ä¹ˆçŠ¶æ€è½¬ç§»å¯ä»¥å†™æˆ<br />
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">â‰¥</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2452em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">])</span></span></span></span>ï¼Œå…¶ä¸­<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ã€‚</p>
<p>ç›´æ¥æšä¸¾kä¼šè¶…æ—¶ï¼Œä½†æ³¨æ„åˆ°<br />
<code>dp[i+1][j] = max(dp[i][j], dp[i+1][jâˆ’c[i]] + v[i])</code><br />
â€”â€”åè€…å·²ç»åŒ…å«äº†â€œå†æ‹¿1ä»¶â€çš„å†³ç­–ï¼Œå› ä¸º<code>dp[i+1][jâˆ’c[i]] + v[i]</code>å¹¶æ²¡æœ‰ç§»åŠ¨ç‰©å“çš„æŒ‡é’ˆï¼Œå› æ­¤æˆ‘ä»¬å®é™…ä¸Šæ‹¿å®Œå½“å‰è¿™ä¸ªä¸œè¥¿ï¼Œå®é™…ä¸Šæ˜¯åœ¨è€ƒè™‘â€œå†æ‹¿ä¸€ä¸ªï¼Œæˆ–è€…é€‰æ‹©æ‹¿ä¸‹ä¸€ä¸ªâ€
äºæ˜¯å¾—åˆ°å’Œ01èƒŒåŒ…<strong>å½¢å¼å®Œå…¨ä¸€æ ·</strong>ã€ä½†<strong>éå†é¡ºåºç›¸å</strong>çš„ç»å…¸æ–¹ç¨‹ï¼š</p>
<p><code>dp[i+1][j] = max(dp[i][j], dp[i+1][jâˆ’c[i]] + v[i])</code></p>
<h3 id="ä»£ç è§£ææ»šåŠ¨æ•°ç»„ä¼˜åŒ–"><a class="header" href="#ä»£ç è§£ææ»šåŠ¨æ•°ç»„ä¼˜åŒ–">ä»£ç è§£æï¼ˆæ»šåŠ¨æ•°ç»„ä¼˜åŒ–ï¼‰</a></h3>
<pre><code class="language-cpp">vector&lt;int&gt; dp(t + 1);          // dp[j]ï¼šå®¹é‡ä¸ºjæ—¶çš„æœ€å¤§ä»·å€¼
for (int i = 0; i &lt; m; ++i) {   // éå†æ‰€æœ‰ç‰©å“
    for (int j = cost[i]; j &lt;= t; ++j) {  // ä»å°åˆ°å¤§æšä¸¾å®¹é‡
        dp[j] = max(dp[j], dp[j - cost[i]] + value[i]); // çŠ¶æ€è½¬ç§»
    }
}
</code></pre>
<h3 id="å…³é”®ç‚¹-1"><a class="header" href="#å…³é”®ç‚¹-1">å…³é”®ç‚¹</a></h3>
<ol>
<li><strong>çŠ¶æ€å®šä¹‰</strong>ï¼šåŒ01èƒŒåŒ…ï¼Œ<code>dp[j]</code>è¡¨ç¤ºå®¹é‡ä¸ºjæ—¶çš„æœ€å¤§ä»·å€¼ã€‚</li>
<li><strong>çŠ¶æ€è½¬ç§»</strong>ï¼šæ–¹ç¨‹å½¢å¼ä¸01èƒŒåŒ…ç›¸åŒï¼Œä½†<strong>ç¬¬äºŒç»´å¼•ç”¨çš„æ˜¯â€œæœ¬è¡Œâ€åˆšåˆšæ›´æ–°è¿‡çš„å€¼</strong>ï¼Œä»è€Œéšå«â€œæ— é™æ¬¡ä½¿ç”¨â€ã€‚</li>
<li><strong>æ­£åºéå†</strong>ï¼šä»å°åˆ°å¤§æšä¸¾å®¹é‡ï¼Œä¿è¯<code>dp[jâˆ’c[i]]</code>åœ¨æœ¬è½®<strong>å·²ç»æ›´æ–°è¿‡</strong>ï¼Œå³å…è®¸å½“å‰ç‰©å“è¢«é‡å¤ä½¿ç”¨ã€‚</li>
</ol>
<h3 id="è®°å¿†å£è¯€"><a class="header" href="#è®°å¿†å£è¯€">è®°å¿†å£è¯€</a></h3>
<blockquote>
<p><strong>01èƒŒåŒ…é€†ç€è·‘ï¼Œå®Œå…¨èƒŒåŒ…é¡ºç€æ‰«ï¼›æ–¹ç¨‹ä¸€æ ·é¡ºåºåï¼Œæ— é™æ¬¡æ•°è‡ªç„¶åˆ°ã€‚</strong></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h2 id="-ç®—æ³•è®²è§£"><a class="header" href="#-ç®—æ³•è®²è§£">ğŸ“– ç®—æ³•è®²è§£</a></h2>
<h3 id="1-é—®é¢˜æ¨¡å‹"><a class="header" href="#1-é—®é¢˜æ¨¡å‹">1. é—®é¢˜æ¨¡å‹</a></h3>
<p>ç»™å®šå¸¦æƒæœ‰å‘å›¾ <code>G=(V,E)</code>ï¼Œæºç‚¹ <code>s</code>ï¼Œæ±‚ <code>s</code> åˆ°æ‰€æœ‰å…¶å®ƒé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼ˆæƒå€¼å’Œæœ€å°ï¼‰ã€‚<br />
å…è®¸æƒå€¼ä¸ºæ­£ï¼Œ<strong>ä¸å…è®¸è´Ÿæƒè¾¹</strong>ï¼ˆå¦åˆ™éœ€ Bellman-Ford/SPFAï¼‰ã€‚</p>
<hr />
<h3 id="2-dijkstra-æ€æƒ³"><a class="header" href="#2-dijkstra-æ€æƒ³">2. Dijkstra æ€æƒ³</a></h3>
<ol>
<li>ç»´æŠ¤ä¸€ä¸ªã€Œå·²ç¡®å®šæœ€çŸ­è·¯å¾„ã€çš„é›†åˆ <code>S</code>ï¼Œåˆå§‹åªæœ‰ <code>s</code>ã€‚</li>
<li>æ¯æ¬¡ä» <code>V-S</code> ä¸­æŒ‘é€‰ä¸€ä¸ªã€Œè·ç¦»æºç‚¹æœ€è¿‘ã€çš„é¡¶ç‚¹ <code>u</code>ï¼ŒåŠ å…¥ <code>S</code>ã€‚</li>
<li>ç”¨ <code>u</code> çš„æ‰€æœ‰å‡ºè¾¹åš<strong>æ¾å¼›æ“ä½œ</strong>ï¼ˆrelaxï¼‰ï¼š<br />
è‹¥ <code>dist[u] + w(u,v) &lt; dist[v]</code>ï¼Œåˆ™æ›´æ–° <code>dist[v]</code>ã€‚</li>
<li>é‡å¤ç¬¬ 2 æ­¥ç›´åˆ°æ‰€æœ‰é¡¶ç‚¹éƒ½åœ¨ <code>S</code> ä¸­ã€‚</li>
</ol>
<p>æ­£ç¡®æ€§è¯æ˜ä¾èµ–äºã€Œéè´Ÿæƒã€ä¸‹çš„è´ªå¿ƒé€‰æ‹©æ€§è´¨ï¼šå½“å‰å †é¡¶æŒ‘å‡ºçš„ <code>u</code> å·²ç»ä¸å¯èƒ½è¢«åç»­èŠ‚ç‚¹å†æ¬¡æ¾å¼›å‡ºæ›´å°çš„å€¼ï¼š
å‡å®šä¸€ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿè¢«ä»¥ä¸¤æ¡è·¯å¾„åˆ°è¾¾ï¼Œä¸å¦¨è®¾ç¬¬ä¸€æ¡è·¯å¾„ä¸ºç›´æ¥åˆ°è¾¾ï¼Œæƒå€¼ä¸º100ï¼Œç¬¬äºŒæ¡è·¯å¾„ä¸ºç»•99ä¸ªèŠ‚ç‚¹åˆ°è¾¾ï¼Œæ¯ä¸ªèŠ‚ç‚¹æƒå€¼ä¸º1ã€‚
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºæ¯æ¬¡å †é¡¶å¼¹å‡ºä»åˆå§‹ç‚¹åˆ°å¯¹åº”èŠ‚ç‚¹çš„æƒå€¼æœ€å°çš„é‚£ä¸€æ¡è·¯å¾„ï¼Œå› æ­¤å®ƒæ¯æ¬¡éƒ½ä¼šä¼˜å…ˆå¼¹å‡ºç»•è·¯çš„è·¯å¾„ã€‚
ï¼ˆå³ä½¿æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œç»•è·¯çš„è·¯å¾„çš„jä¾ç„¶æ˜¯99ï¼Œå°äºç›´æ¥èµ°çš„100ï¼‰
å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®è®¤ï¼Œå †é¡¶é¦–æ¬¡å¼¹å‡ºçš„æ–¹æ¡ˆå°±æ˜¯æœ€ä¼˜çš„</p>
<pre><code class="language-c++">#include &lt;bits/stdc++.h&gt;
using i64 = long long;
struct Edge{
    int to;
    i64 w;
    bool operator&lt;(const Edge&amp; b)const{
        return w &gt; b.w;
        //ä¸ºäº†è·å¾—æœ€å°å †ï¼Œéœ€è¦åè¿‡æ¥
    }
    Edge(int t,i64 w)
        :to(t),w(w){
    }
};
int main(){
    i64 n,m,s;
    std::cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;
    std::vector&lt;std::vector&lt;Edge&gt;&gt; conn(n+1);
    // åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ
    for(int i = 0;i &lt; m;++i){
        int a,b,c;
        std::cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;
        conn[a].push_back({b,c}); 
    }
    // å»ºç«‹å›¾
    std::priority_queue&lt;Edge&gt; q;
    // ä¼˜å…ˆé˜Ÿåˆ—ï¼Œä¿è¯æ¯æ¬¡å¼¹å‡ºçš„éƒ½æ˜¯è·ç¦»å·²ç»æ›´æ–°çš„èŠ‚ç‚¹æœ€è¿‘çš„èŠ‚ç‚¹
    q.push({s,0});
    // ä¼˜å…ˆé˜Ÿåˆ—ä¸­å‹å…¥åˆå§‹èŠ‚ç‚¹
    std::vector&lt;i64&gt; minDistance(n+1,std::numeric_limits&lt;i64&gt;::max());
    // ç»“æœå‘é‡ï¼Œå­˜å‚¨åˆå§‹èŠ‚ç‚¹åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œåˆå§‹åŒ–ä¸ºæ­£æ— ç©·
    minDistance[s] = 0;
    // å°†åˆå§‹èŠ‚ç‚¹åˆ°è‡ªå·±çš„è·ç¦»è®¾ç½®ä¸º0
    std::vector&lt;char&gt; vis(n+1,0);
    // viså‘é‡ï¼Œé¿å…é‡å¤æ›´æ–°
    while(!q.empty()){
        auto [i,j] = q.top();q.pop();
        // è·å–å †é¡¶çš„èŠ‚ç‚¹ï¼ˆå³è·ç¦»å·²æ›´æ–°èŠ‚ç‚¹æœ€è¿‘çš„èŠ‚ç‚¹ï¼‰
        // iä»£è¡¨å½“å‰èŠ‚ç‚¹ç´¢å¼•ï¼Œjä»£è¡¨ä»åˆå§‹èŠ‚ç‚¹åˆ°ièŠ‚ç‚¹çš„æœ€å°æƒå€¼
        if(vis[i])continue;
        vis[i] = 1;
        // æ³¨æ„ï¼šä¸å†™è¿™ä¸ªvisä¾ç„¶èƒ½å¾—åˆ°æ­£ç¡®ç»“æœï¼Œä½†æ˜¯å®ƒä¼štle
        // å‡å®šä¸€ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿè¢«ä»¥ä¸¤æ¡è·¯å¾„åˆ°è¾¾ï¼Œä¸å¦¨è®¾ç¬¬ä¸€æ¡è·¯å¾„ä¸ºç›´æ¥åˆ°è¾¾ï¼Œæƒå€¼ä¸º100ï¼Œç¬¬äºŒæ¡è·¯å¾„ä¸ºç»•99ä¸ªèŠ‚ç‚¹åˆ°è¾¾ï¼Œæ¯ä¸ªèŠ‚ç‚¹æƒå€¼ä¸º1
        // åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºæ¯æ¬¡å †é¡¶å¼¹å‡ºä»åˆå§‹ç‚¹åˆ°å¯¹åº”èŠ‚ç‚¹çš„æƒå€¼æœ€å°çš„é‚£ä¸€æ¡è·¯å¾„ï¼Œå› æ­¤å®ƒæ¯æ¬¡éƒ½ä¼šä¼˜å…ˆå¼¹å‡ºç»•è·¯çš„è·¯å¾„
        // ï¼ˆå³ä½¿æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œç»•è·¯çš„è·¯å¾„çš„jä¾ç„¶æ˜¯99ï¼Œå°äºç›´æ¥èµ°çš„100ï¼‰
        // å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®è®¤ï¼Œå¦‚æœå †é¡¶å¼¹å‡ºè¿™ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹ä¸€å®šå·²ç»æ˜¯æœ€ä¼˜çš„èŠ‚ç‚¹
        // ï¼ˆä½†æ˜¯ï¼Œä½œä¸ºå…¶ä»–èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œç¡®å®å¯èƒ½è¢«æ›´æ–°å¤šæ¬¡ï¼‰
        for(auto [a,b]:conn[i]){
            // é€šè¿‡é‚»æ¥çŸ©é˜µè®¿é—®å½“å‰èŠ‚ç‚¹é“¾æ¥çš„èŠ‚ç‚¹
            // aä»£è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ç´¢å¼•ï¼Œbä»£è¡¨è·ç¦»ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„è·ç¦»
            if(minDistance[a] &gt; j + b){
                // å¦‚æœé€šè¿‡å½“å‰è·¯å¾„èƒ½æ›´çŸ­çš„åˆ°è¾¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±æ›´æ–°
                minDistance[a] = j + b;
                q.push({a,minDistance[a]});
            }
        }
    }
    for(int i = 1;i &lt;= n;++i){
        std::cout&lt;&lt;minDistance[i]&lt;&lt;" ";
    }
    std::cout&lt;&lt;std::endl;
    return 0;
}

</code></pre>
<h3 id="å¤æ‚åº¦è®¡ç®—"><a class="header" href="#å¤æ‚åº¦è®¡ç®—">å¤æ‚åº¦è®¡ç®—</a></h3>
<p>æŠŠå¤æ‚åº¦æ‹†æˆ<strong>ä¸¤éƒ¨åˆ†</strong>çœ‹å°±æ¸…æ¥šäº†ï¼š</p>
<ol>
<li>
<p>æ¯ä¸ªé¡¶ç‚¹<strong>æœ€å¤šè¿›å †ä¸€æ¬¡</strong><br />
å…± <code>n</code> ä¸ªé¡¶ç‚¹ â†’ å †ä¸­æ’å…¥/å¼¹å‡º <code>n</code> æ¬¡ï¼Œæ¯æ¬¡ <code>O(log n)</code><br />
åˆè®¡ <code>O(n log n)</code></p>
</li>
<li>
<p>æ¯æ¡è¾¹<strong>æœ€å¤šè§¦å‘ä¸€æ¬¡æ¾å¼›å¹¶æˆåŠŸæ›´æ–°</strong><br />
å…± <code>m</code> æ¡è¾¹ â†’ æ¯æ¬¡æ›´æ–°è¦æŠŠæ–°è·ç¦» <code>push</code> è¿›å †ï¼Œ<code>O(log n)</code><br />
åˆè®¡ <code>O(m log n)</code></p>
</li>
</ol>
<p>æŠŠä¸¤éƒ¨åˆ†ç›¸åŠ å°±æ˜¯<br />
<code>O(n log n + m log n) = O((n + m) log n)</code></p>
<ul>
<li>å½“å›¾<strong>ç¨€ç–</strong>ï¼ˆ<code>m â‰ˆ n</code>ï¼‰æ—¶ï¼Œå¤æ‚åº¦ç”± <code>n log n</code> ä¸»å¯¼ï¼›</li>
<li>å½“å›¾<strong>ç¨ å¯†</strong>ï¼ˆ<code>m â‰ˆ nÂ²</code>ï¼‰æ—¶ï¼Œå¤æ‚åº¦ç”± <code>m log n</code> ä¸»å¯¼ã€‚</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h2 id="-ç®—æ³•è®²è§£-1"><a class="header" href="#-ç®—æ³•è®²è§£-1">ğŸ“– ç®—æ³•è®²è§£</a></h2>
<h3 id="1-é—®é¢˜æ¨¡å‹-1"><a class="header" href="#1-é—®é¢˜æ¨¡å‹-1">1. é—®é¢˜æ¨¡å‹</a></h3>
<p>ç»™å®šå¸¦æƒæœ‰å‘å›¾ <code>G=(V,E)</code>ï¼Œæºç‚¹ <code>s</code>ï¼Œæ±‚ <code>s</code> åˆ°æ‰€æœ‰å…¶å®ƒé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼ˆæƒå€¼å’Œæœ€å°ï¼‰ã€‚<br />
<strong>å…è®¸è´Ÿæƒè¾¹</strong>ï¼Œä½†<strong>ä¸å…è®¸è´Ÿæƒç¯</strong>ï¼ˆå¦åˆ™æœ€çŸ­è·¯å¾„æ— å®šä¹‰ï¼‰ã€‚<br />
è‹¥å›¾ä¸­å­˜åœ¨ä» <code>s</code> å¯è¾¾çš„è´Ÿæƒç¯ï¼Œç®—æ³•èƒ½å¤Ÿæ£€æµ‹å¹¶æŠ¥å‘Šã€‚</p>
<hr />
<h3 id="2-bellman-ford-æ€æƒ³"><a class="header" href="#2-bellman-ford-æ€æƒ³">2. Bellman-Ford æ€æƒ³</a></h3>
<ol>
<li>ç»´æŠ¤ä¸€ä¸ªè·ç¦»æ•°ç»„ <code>dist[1â€¦n]</code>ï¼Œåˆå§‹æ—¶ <code>dist[s]=0</code>ï¼Œå…¶ä½™ä¸ºæ­£æ— ç©·ã€‚</li>
<li>è¿›è¡Œ <code>n-1</code> è½®ã€Œå…¨è¾¹æ¾å¼›ã€ï¼š<br />
å¯¹æ¯æ¡è¾¹ <code>(u,v,w)</code>ï¼Œè‹¥ <code>dist[u]+w &lt; dist[v]</code>ï¼Œåˆ™æ›´æ–° <code>dist[v]</code>ã€‚</li>
<li>ç¬¬ <code>n</code> è½®å†æ‰«ææ‰€æœ‰è¾¹ï¼Œè‹¥ä»èƒ½æ¾å¼›ï¼Œåˆ™è¯´æ˜å­˜åœ¨è´Ÿæƒç¯ã€‚</li>
</ol>
<p>æ­£ç¡®æ€§è¯æ˜ä¾èµ–äºã€Œè·¯å¾„è¾¹æ•°ã€å½’çº³ï¼š<br />
ç¬¬ <code>k</code> è½®ç»“æŸåï¼Œæ‰€æœ‰<strong>æœ€å¤šç”± <code>k</code> æ¡è¾¹ç»„æˆ</strong>çš„æœ€çŸ­è·¯å¾„éƒ½å·²æ±‚å‡ºã€‚<br />
ç”±äºç®€å•è·¯å¾„æœ€å¤š <code>n-1</code> æ¡è¾¹ï¼Œ<code>n-1</code> è½®å³å¯ä¿è¯æ”¶æ•›ï¼›ç¬¬ <code>n</code> è½®è‹¥ä»æ¾å¼›ï¼Œè¯´æ˜å­˜åœ¨æ— é™ç¼©çŸ­çš„è´Ÿç¯ã€‚</p>
<hr />
<h3 id="3-ä»£ç å®ç°"><a class="header" href="#3-ä»£ç å®ç°">3. ä»£ç å®ç°</a></h3>
<p>ä»¥ä¸‹ä»£ç ä¸ç»™å‡º Dijkstra ç¤ºä¾‹é£æ ¼ä¿æŒä¸€è‡´ï¼š</p>
<ul>
<li>é‡‡ç”¨ <code>i64</code> ç±»å‹</li>
<li>ä½¿ç”¨ <code>vector&lt;char&gt;</code> åšæ ‡å¿—</li>
<li>æ³¨é‡Šé£æ ¼ã€å˜é‡å‘½åã€è¾“å…¥è¾“å‡ºæ ¼å¼å‡ä»¿ç…§åŸç¤ºä¾‹</li>
<li>é¢å¤–è¿”å›ã€Œæ˜¯å¦å­˜åœ¨è´Ÿæƒç¯ã€ä¿¡æ¯</li>
</ul>
<pre><code class="language-c++">#include &lt;bits/stdc++.h&gt;
using i64 = long long;
struct Edge {
    int from, to;
    i64 w;
    Edge(int u, int v, i64 c) : from(u), to(v), w(c) {}
};
int main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);

    i64 n, m, s;
    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; s;

    std::vector&lt;Edge&gt; edges;
    // æœ¬é¢˜æš‚æ—¶ä¸éœ€è¦ä½¿ç”¨é‚»æ¥çŸ©é˜µ
    edges.reserve(m);
    for (int i = 0; i &lt; m; ++i) {
        int a, b, c;
        std::cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;
        edges.emplace_back(a, b, c);
    }

    const i64 INF = std::numeric_limits&lt;i64&gt;::max();
    std::vector&lt;i64&gt; dist(n + 1, INF);
    dist[s] = 0;

    // n-1 è½®æ¾å¼›
    for (int round = 1; round &lt; n; ++round) {
        bool updated = false;
        for (auto &amp;[u, v, w] : edges) {
            if (dist[u] != INF &amp;&amp; dist[v] &gt; dist[u] + w) {
                dist[v] = dist[u] + w;
                updated = true;
            }
        }
        if (!updated) break;          // æå‰æ”¶æ•›
    }

    // ç¬¬ n è½®æ£€æµ‹è´Ÿç¯
    bool hasNegCycle = false;
    for (auto &amp;[u, v, w] : edges) {
        if (dist[u] != INF &amp;&amp; dist[v] &gt; dist[u] + w) {
            hasNegCycle = true;
            break;
        }
    }

    if (hasNegCycle) {
        std::cout &lt;&lt; "NEGATIVE CYCLE DETECTED\n";
    } else {
        for (int i = 1; i &lt;= n; ++i) {
            if (dist[i] == INF) std::cout &lt;&lt; "INF ";
            else                std::cout &lt;&lt; dist[i] &lt;&lt; ' ';
        }
        std::cout &lt;&lt; '\n';
    }
    return 0;
}
</code></pre>
<p>ä¸‹é¢æ˜¯é‚»æ¥è¡¨ç‰ˆæœ¬çš„å®ç°ï¼ˆä»…é£æ ¼å·®å¼‚ï¼‰</p>
<pre><code class="language-c++">#include &lt;bits/stdc++.h&gt;
using i64 = long long;
struct Edge {
    int to;
    i64 w;
    Edge(int v, i64 c) : to(v), w(c) {}
};
int main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);

    i64 n, m, s;
    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; s;

    std::vector&lt;std::vector&lt;Edge&gt;&gt; edges(n+1);
    for (int i = 0; i &lt; m; ++i) {
        int a, b, c;
        std::cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;
        edges[a].emplace_back({b, c});
    }

    const i64 INF = std::numeric_limits&lt;i64&gt;::max();
    std::vector&lt;i64&gt; dist(n + 1, INF);
    dist[s] = 0;

    bool updated = true;
    // åˆ¤æ–­æå‰æ”¶æ•›
    // n-1 è½®æ¾å¼›
    for (int round = 1; round &lt; n &amp;&amp; updated; ++round) {
        updated = false;
        for(int u = 0;u &lt;= n; u++){
            if(dist[u] == INF){
                continue;
            }
            for(auto&amp; [v,w] : edges[u]){
                if(dist[u] + w &lt; dist[v]){
                    dist[v] = dist[u] + w;
                    updated = true;
                }
            }
        }

    }

    // ç¬¬ n è½®æ£€æµ‹è´Ÿç¯
    bool hasNegCycle = false;
    for (int u = 1; u &lt;= n; ++u) {
        if (dist[u] == INF) continue;
        for (auto &amp;[v, w] : edges[u]) {
            if (dist[u] + w &lt; dist[v]) {
                hasNegCycle = true;
                break;
            }
        }
        if (hasNegCycle) break;
    }

    if (hasNegCycle) {
        std::cout &lt;&lt; "NEGATIVE CYCLE DETECTED\n";
    } else {
        for (int i = 1; i &lt;= n; ++i) {
            if (dist[i] == INF) std::cout &lt;&lt; "INF ";
            else                std::cout &lt;&lt; dist[i] &lt;&lt; ' ';
        }
        std::cout &lt;&lt; '\n';
    }
    return 0;
}
</code></pre>
<hr />
<h3 id="4-ä½¿ç”¨å°è´´å£«"><a class="header" href="#4-ä½¿ç”¨å°è´´å£«">4. ä½¿ç”¨å°è´´å£«</a></h3>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ <code>O(nÂ·m)</code>ï¼Œè¾¹æ•°è¾ƒå¤§æ—¶è¯·æ”¹ç”¨ SPFAï¼ˆé˜Ÿåˆ—ä¼˜åŒ– Bellman-Fordï¼‰ã€‚</li>
<li>è‹¥åªéœ€åˆ¤æ–­è´Ÿç¯ï¼Œå¯åœ¨ç¬¬ <code>n</code> è½®åç»§ç»­æ¾å¼›å¹¶è®°å½•å“ªäº›ç‚¹è¢«æ›´æ–°ï¼Œè¿™äº›ç‚¹å³åœ¨è´Ÿç¯ä¸Šæˆ–å¯è¾¾è´Ÿç¯ã€‚</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h2 id="-ç®—æ³•è®²è§£-2"><a class="header" href="#-ç®—æ³•è®²è§£-2">ğŸ“– ç®—æ³•è®²è§£</a></h2>
<h3 id="1-é—®é¢˜æ¨¡å‹-2"><a class="header" href="#1-é—®é¢˜æ¨¡å‹-2">1. é—®é¢˜æ¨¡å‹</a></h3>
<p>åŒ Bellman-Fordï¼š<br />
ç»™å®šå¸¦æƒæœ‰å‘å›¾ <code>G=(V,E)</code>ï¼Œæºç‚¹ <code>s</code>ï¼Œæ±‚ <code>s</code> åˆ°æ‰€æœ‰å…¶å®ƒé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚<br />
<strong>å…è®¸è´Ÿæƒè¾¹</strong>ï¼Œ<strong>ä¸å…è®¸è´Ÿæƒç¯</strong>ï¼›è‹¥å­˜åœ¨ä» <code>s</code> å¯è¾¾çš„è´Ÿæƒç¯ï¼Œç®—æ³•èƒ½å¤Ÿæ£€æµ‹å¹¶æŠ¥å‘Šã€‚</p>
<hr />
<h3 id="2-spfa-æ€æƒ³shortest-path-faster-algorithm"><a class="header" href="#2-spfa-æ€æƒ³shortest-path-faster-algorithm">2. SPFA æ€æƒ³ï¼ˆShortest Path Faster Algorithmï¼‰</a></h3>
<ol>
<li>åªç»´æŠ¤ä¸€ä¸ª<strong>æ™®é€šé˜Ÿåˆ—</strong> <code>q</code>ï¼Œåˆå§‹æ”¾å…¥æºç‚¹ <code>s</code>ã€‚</li>
<li>ç”¨ <code>inQueue[u]</code> æ ‡è®°ç‚¹ <code>u</code> æ˜¯å¦å·²åœ¨é˜Ÿåˆ—ä¸­ï¼Œé¿å…é‡å¤å…¥é˜Ÿã€‚</li>
<li>æ¯æ¬¡å¼¹å‡ºé˜Ÿé¦– <code>u</code>ï¼Œå¯¹å…¶<strong>æ‰€æœ‰å‡ºè¾¹</strong>åšæ¾å¼›ï¼š<br />
è‹¥ <code>dist[u]+w(u,v) &lt; dist[v]</code>ï¼Œåˆ™æ›´æ–° <code>dist[v]</code>ï¼›<br />
è‹¥ <code>v</code> ä¸åœ¨é˜Ÿåˆ—ï¼Œåˆ™æŠŠ <code>v</code> å…¥é˜Ÿã€‚</li>
<li>ç”¨ <code>cnt[v]</code> è®°å½•<strong>å½“å‰æœ€çŸ­è·¯å¾„åŒ…å«çš„è¾¹æ•°</strong>ï¼›<br />
è‹¥æŸæ¬¡æ›´æ–°å <code>cnt[v] â‰¥ n</code>ï¼Œè¯´æ˜å­˜åœ¨è´Ÿæƒç¯ã€‚</li>
</ol>
<p>æ­£ç¡®æ€§ä¾æ—§ä¾èµ– Bellman-Ford çš„æ¾å¼›è§„åˆ™ï¼Œä½†<strong>åªæŠŠçœŸæ­£å‘ç”Ÿæ›´æ–°çš„ç‚¹å…¥é˜Ÿ</strong>ï¼Œå¹³å‡å¤æ‚åº¦ <code>O(m)</code>ï¼Œæœ€åä»ä¸º <code>O(nÂ·m)</code>ã€‚</p>
<hr />
<h3 id="3-ä»£ç å®ç°-1"><a class="header" href="#3-ä»£ç å®ç°-1">3. ä»£ç å®ç°</a></h3>
<p>é£æ ¼ç»§ç»­ä»¿ç…§åŸ Dijkstra ç¤ºä¾‹ï¼š</p>
<ul>
<li><code>i64</code> ç±»å‹ã€<code>vector&lt;char&gt;</code> æ ‡è®°ã€<code>priority_queue</code> æ”¹ä¸º <code>queue</code></li>
<li>æ³¨é‡Šã€å˜é‡å‘½åã€è¾“å…¥è¾“å‡ºæ ¼å¼ä¿æŒä¸€è‡´</li>
<li>é¢å¤–è¿”å›ã€Œæ˜¯å¦å­˜åœ¨è´Ÿæƒç¯ã€ä¿¡æ¯</li>
</ul>
<pre><code class="language-c++">#include &lt;bits/stdc++.h&gt;
using i64 = long long;
struct Edge {
    int to;
    i64 w;
    Edge(int t, i64 c) : to(t), w(c) {}
};
int main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);

    i64 n, m, s;
    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; s;

    std::vector&lt;std::vector&lt;Edge&gt;&gt; conn(n + 1);
    for (int i = 0; i &lt; m; ++i) {
        int a, b, c;
        std::cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;
        conn[a].emplace_back(b, c);
    }

    const i64 INF = std::numeric_limits&lt;i64&gt;::max();
    std::vector&lt;i64&gt; dist(n + 1, INF);
    std::vector&lt;char&gt; inQueue(n + 1, 0);
    std::vector&lt;int&gt; cnt(n + 1, 0);   // è®°å½•æœ€çŸ­è·¯å¾„è¾¹æ•°
    std::queue&lt;int&gt; q;

    dist[s] = 0;
    q.push(s);
    inQueue[s] = 1;

    bool hasNegCycle = false;
    while (!q.empty() &amp;&amp; !hasNegCycle) {
        int u = q.front();
        q.pop();
        inQueue[u] = 0;

        for (auto &amp;[v, w] : conn[u]) {
            if (dist[u] != INF &amp;&amp; dist[v] &gt; dist[u] + w) {
                dist[v] = dist[u] + w;
                cnt[v] = cnt[u] + 1;
                if (cnt[v] &gt;= n) {          // è´Ÿç¯æ£€æµ‹
                    hasNegCycle = true;
                    break;
                }
                if (!inQueue[v]) {
                    q.push(v);
                    inQueue[v] = 1;
                }
            }
        }
    }

    if (hasNegCycle) {
        std::cout &lt;&lt; "NEGATIVE CYCLE DETECTED\n";
    } else {
        for (int i = 1; i &lt;= n; ++i) {
            if (dist[i] == INF) std::cout &lt;&lt; "INF ";
            else                std::cout &lt;&lt; dist[i] &lt;&lt; ' ';
        }
        std::cout &lt;&lt; '\n';
    }
    return 0;
}
</code></pre>
<hr />
<h3 id="4-ä½¿ç”¨å°è´´å£«-1"><a class="header" href="#4-ä½¿ç”¨å°è´´å£«-1">4. ä½¿ç”¨å°è´´å£«</a></h3>
<ul>
<li>å¹³å‡æ—¶é—´å¤æ‚åº¦ <code>O(m)</code>ï¼Œç½‘æ ¼å›¾ã€éšæœºå›¾å¸¸è¿œä¼˜äº <code>O(nÂ·m)</code>ã€‚</li>
<li>è‹¥åªéœ€åˆ¤æ–­<strong>å…¨å›¾ä»»æ„è´Ÿç¯</strong>ï¼Œå¯ä»<strong>è™šæ‹Ÿè¶…çº§æº</strong>å‘æ‰€æœ‰ç‚¹è¿ <code>0</code> è¾¹ï¼Œå†è·‘ SPFAï¼›è‹¥æŸç‚¹ <code>cnt[v] â‰¥ n+1</code> å³è¯´æ˜è´Ÿç¯å­˜åœ¨ã€‚</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h2 id="å‰æƒ…æè¦"><a class="header" href="#å‰æƒ…æè¦">å‰æƒ…æè¦ï¼š</a></h2>
<ul>
<li>dijkstraç®—æ³•çš„å¤æ‚åº¦:    <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></li>
<li>Bellmen-ford å¤æ‚åº¦:  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>è¿™äº›ç®—æ³•æœ‰å¦‚ä¸‹ç¼ºç‚¹ï¼š</p>
<ol>
<li>å¤æ‚åº¦ä¾èµ–è¾¹æ•°mï¼Œå½“è¾¹æ•°<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>æ—¶ï¼Œæ•´ä½“ç®—æ³•çš„å¤æ‚åº¦ä¼šæ¥è¿‘<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ä¸<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>ç®—æ³•åªèƒ½æ±‚å•æºåˆ°æ‰€æœ‰ç‚¹çš„è·ç¦»ï¼Œå¦‚æœè¦æ±‚ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œé‚£å°±åªèƒ½næ¬¡è°ƒç”¨ä¸Šè¿°ç®—æ³•ï¼Œæœ€å·®å¤æ‚åº¦æ¥åˆ°äº†<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>ä¸<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå®Œå…¨æ— æ³•æ¥å—</li>
</ol>
<h1 id="floydç®—æ³•å¼—æ´›ä¼Šå¾·ç®—æ³•"><a class="header" href="#floydç®—æ³•å¼—æ´›ä¼Šå¾·ç®—æ³•">Floydç®—æ³•ï¼ˆå¼—æ´›ä¼Šå¾·ç®—æ³•ï¼‰</a></h1>
<h2 id="ç®—æ³•æ ¸å¿ƒä»‹ç»"><a class="header" href="#ç®—æ³•æ ¸å¿ƒä»‹ç»">ç®—æ³•æ ¸å¿ƒä»‹ç»</a></h2>
<h3 id="ç®—æ³•æ ¸å¿ƒ"><a class="header" href="#ç®—æ³•æ ¸å¿ƒ">ç®—æ³•æ ¸å¿ƒ</a></h3>
<p>è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒéå¸¸æ¥è¿‘<strong>åŠ¨æ€è§„åˆ’</strong>
ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³éå¸¸ç®€å•ï¼š
å¯¹äºä»»æ„ä¸¤ä¸ªç‚¹<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å–ä¸€ä¸ªç‚¹<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼Œå¹¶ä¸”å°†è¿é€š<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>çš„å…¨ä½“è·¯å¾„åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li>ç»è¿‡<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>çš„</li>
<li>ä¸ç»è¿‡çš„<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>çš„</li>
</ul>
<p>å‡è®¾æˆ‘ä»¬ä½¿ç”¨<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>æ¥è¡¨ç¤º<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>ä¹‹é—´çš„ï¼Œ<strong>ä¸ç»è¿‡å¤§äº<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>çš„ç‚¹</strong>çš„æœ€çŸ­è·¯é•¿åº¦ï¼Œé‚£ä¹ˆå®ƒä¾¿åªå¯èƒ½ä»ä¸¤ç§çŠ¶æ€è½¬ç§»è€Œæ¥ï¼š</p>
<ul>
<li>æœ€çŸ­è·¯ä¸Šæ²¡æœ‰kï¼Œä¿ç•™<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>ï¼›</li>
<li>æˆ–è€…æœ€çŸ­è·¯ç»è¿‡käº†ï¼Œä¸º<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></li>
</ul>
<p>é‚£ä¹ˆï¼Œæ ¸å¿ƒçš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹å³
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">])</span></span></span></span></p>
<h3 id="ç©ºé—´ä¼˜åŒ–"><a class="header" href="#ç©ºé—´ä¼˜åŒ–">ç©ºé—´ä¼˜åŒ–</a></h3>
<p>æ˜¾ç„¶ï¼Œå½“å‰ä»£ç çš„ç©ºé—´å¤æ‚åº¦æ˜¯<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå¤ªä¸ä¼˜é›…
æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œç”±äº<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>æ€»æ˜¯æˆç«‹çš„ï¼ˆå› ä¸ºè‡ªå·±åˆ°è‡ªå·±çš„è·ç¦»æ€»æ˜¯0ï¼‰ï¼Œ
å› æ­¤æœ‰ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">])</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span>,</li>
<li>åŒç†ï¼š<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></li>
</ul>
<p>å› æ­¤ï¼Œä¸éš¾å‘ç°ï¼Œç±»ä¼¼äºæ»šåŠ¨æ•°ç»„ä¼˜åŒ–ï¼Œæˆ‘ä»¬å®Œå…¨æ²¡æœ‰å¿…è¦ä¿ç•™ç¬¬ä¸€ä¸ªkæ•°ç»„--</p>
<ul>
<li>å¦‚æœä»<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>è½¬ç§»è€Œæ¥ï¼Œé‚£æœ¬åœ°å°±æ˜¯åŸæ¥çš„å€¼ï¼›</li>
<li>å¦‚æœä»åè€…è½¬ç§»è€Œæ¥ï¼Œæ›´æ–°å‰åä¸¤é¡¹çš„æ•°å€¼éƒ½æ²¡æœ‰ä»»ä½•å·®å¼‚ã€‚</li>
</ul>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥åšå‡ºä¼˜åŒ–ï¼Œçœç•¥æ‰kæ•°ç»„ï¼Œå°†ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ°<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚</p>
<h2 id="æ ¸å¿ƒä»£ç "><a class="header" href="#æ ¸å¿ƒä»£ç ">æ ¸å¿ƒä»£ç </a></h2>
<pre><code class="language-c++">using i64 = long long;
constexpr i64 INF = std::numeric_limits&lt;i64&gt;::max();
std::vector&lt;std::vector&lt;i64&gt;&gt;dp(n+1,std::vector&lt;i64&gt;(n+1,INF));
// æ­¤å¤„æ„å»ºé‚»æ¥çŸ©é˜µ
for(int k = 1;k &lt;= n; ++k){
    for(int i = 1;i &lt;= n; ++i){
        for(int j = 1;j &lt;= n; ++j){
            if(dp[i][k] &lt; INF &amp;&amp; dp[k][j] &lt; INF)
                dp[i][j] = std::min(dp[i][j],dp[i][k]+dp[k][j]);
        }      
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="c-smilo-and-minecraft"><a class="header" href="#c-smilo-and-minecraft">C. Smilo and Minecraft</a></h1>
<p>The boy Smilo is playing Minecraft! To prepare for the battle with the dragon, he needs a lot of golden apples, and for that, he requires a lot of gold. Therefore, Smilo goes to the mine.</p>
<p>The mine is a rectangular grid of size nÃ—m, where each cell can be either gold ore, stone, or an empty cell. Smilo can blow up dynamite in any empty cell. When dynamite explodes in an empty cell with coordinates (x,y), all cells within a square of side 2k+1 centered at cell (x,y) become empty. If gold ore was located <strong>strictly inside</strong> this square (not on the boundary), it disappears. However, if the gold ore was on the boundary of this square, Smilo collects that gold.</p>
<p>Dynamite can only be detonated inside the mine, but the explosion square can extend beyond the mine's boundaries.</p>
<p>Determine the maximum amount of gold that Smilo can collect.</p>
<p><strong>Input</strong></p>
<p>Each test contains multiple test cases. The first line contains the number of test cases t (1â‰¤tâ‰¤104). The description of the test cases follows.</p>
<p>The first line of each test case contains three integers n, m, and k (1â‰¤n,m,kâ‰¤500) â€” the number of rows, columns, and the explosion parameter k, respectively.</p>
<p>Each of the following n lines contains m characters, each of which is equal to '.', '#', or 'g', where '.' â€” is an empty cell, '#' â€” is stone, 'g' â€” is gold. It is guaranteed that at least one of the cells is empty.</p>
<p>It is guaranteed that the sum nâ‹…m across all test cases does not exceed 2.5â‹…105.</p>
<p><strong>Output</strong></p>
<p>For each test case, output a single integer â€” the maximum amount of gold that can be obtained.</p>
<p><strong>Example</strong></p>
<p>Input</p>
<pre><code>3
2 3 1
#.#
g.g
2 3 2
#.#
g.g
3 4 2
.gg.
g..#
g##.
</code></pre>
<p>Output</p>
<pre><code>2
0
4
</code></pre>
<hr />
<h3 id="è§£é¢˜æ€è·¯"><a class="header" href="#è§£é¢˜æ€è·¯">è§£é¢˜æ€è·¯</a></h3>
<p>â€‹	è¯¥é¢˜æ˜¯ä¸€ä¸ªè´ªå¿ƒé¢˜ï¼Œåªéœ€è¦æ‰¾åˆ°æ‰€æœ‰åˆå§‹ç©ºä½å¯¹åº”çŸ©å½¢èŒƒå›´å†…é”€æ¯çš„é‡‘å—ä¸­çš„æœ€å°å€¼ã€‚ç„¶ååœ¨åˆå§‹çˆ†ç‚¸çš„èŒƒå›´å†…è¿›è¡Œå¹³æ»‘ç§»åŠ¨è¿›è¡Œçˆ†ç ´å³å¯æ— æŸè€—çš„å¾—åˆ°å‰©ä½™æ‰€æœ‰é‡‘å—ï¼Œå³<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9456em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">orye</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">Gl</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä½¿ç”¨äºŒç»´å‰ç¼€å’Œè¿›è¡Œæ±‚è§£ã€‚</p>
<h3 id="é¢˜è§£"><a class="header" href="#é¢˜è§£">é¢˜è§£</a></h3>
<pre><code class="language-c++">#include&lt;iostream&gt;
#include&lt;vector&gt;
using namespace std;
int clamp(int num,int max){
	return (num &lt; 1?0:(num &gt; max?max:num));
}
int query(vector&lt;vector&lt;int&gt;&gt;&amp; numbers,int x,int y,int k,int n,int m){
	int x1 = clamp(x + k,n); int y1 = clamp(y + k,m);
	int x2 = clamp(x - k - 1,n); int y2 = clamp(y - k - 1,m);
	int x3 = clamp(x + k,n); int y3 = clamp(y - k - 1,m);
	int x4 = clamp(x - k - 1,n); int y4 = clamp(y + k,m);
	return numbers[x1][y1] + numbers[x2][y2] - numbers[x3][y3] - numbers[x4][y4];
}
int main(){
	int T;
	cin &gt;&gt; T;
	while(T--&gt;0){
		int n,m,k;
		cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;
		vector&lt;vector&lt;int&gt;&gt; ps(n+1,vector&lt;int&gt;(m+1));
		vector&lt;pair&lt;int,int&gt;&gt; empty;
		for(int i = 1;i &lt;= n;i++){
			for(int j = 1;j &lt;= m;j++)
			{
				char temp;
				cin &gt;&gt; temp;
				if(temp == '.'){
					ps[i][j] = ps[i][j-1] + ps[i-1][j] - ps[i-1][j-1]; 
					empty.emplace_back(make_pair(i,j));
				}else if(temp == 'g'){
					ps[i][j] = 1 + ps[i][j-1] + ps[i-1][j] - ps[i-1][j-1];
				}else{
					ps[i][j] = ps[i][j-1] + ps[i-1][j] - ps[i-1][j-1]; 
				}
			}	
		}
		int min = 2000000;
		for(auto&amp; [x,y]:empty){
			int temp = query(ps,x,y,k-1,n,m);
			if(temp &lt; min){
				min = temp;
			}
		}
		cout &lt;&lt; ps[n][m] - min &lt;&lt; endl;
	}
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="d-cheater"><a class="header" href="#d-cheater">D. Cheater</a></h1>
<p>You are playing a new card game in a casino with the following rules:</p>
<ol>
<li>The game uses a deck of 2n cards with different values.</li>
<li>The deck is evenly split between the player and the dealer: each receives n cards.</li>
<li>Over n rounds, the player and the dealer simultaneously play one top card from their hand. The cards are compared, and the point goes to the one whose card has a higher value. The winning card is removed from the game, while the losing card is returned to the hand <strong>and placed on top of the other cards</strong> in the hand of the player who played it.</li>
</ol>
<p>Note that the game always lasts <strong>exactly</strong> n rounds.</p>
<p>You have tracked the shuffling of the cards and know the order of the cards in the dealer's hand (from top to bottom). You want to maximize your score, so you can swap any two cards in your hand <strong>no more than once</strong> (to avoid raising suspicion).</p>
<p>Determine the maximum number of points you can achieve.</p>
<p><strong>Input</strong></p>
<p>Each test contains multiple test cases. The first line contains the number of test cases t (1â‰¤tâ‰¤5â‹…104). The description of the test cases follows.</p>
<p>The first line of each test case contains a single integer n (1â‰¤nâ‰¤2â‹…105) â€” the number of cards in the player's hand.</p>
<p>The second line of each test case contains n integers a1,a2,â€¦,an (1â‰¤aiâ‰¤2n) â€” the values of the cards in the player's hand from top to bottom.</p>
<p>The third line of each test case contains n integers b1,b2,â€¦,bn (1â‰¤biâ‰¤2n) â€” the values of the cards in the dealer's hand from top to bottom.</p>
<p>It is guaranteed that the values of all cards are distinct.</p>
<p>It is guaranteed that the sum of n over all test cases does not exceed 2â‹…105.</p>
<p><strong>Output</strong></p>
<p>For each test case, output a single integer â€” the maximum number of points you can achieve.</p>
<p><strong>Example</strong></p>
<p>Input</p>
<pre><code>3
7
13 7 4 9 12 10 2
6 1 14 3 8 5 11
3
1 6 5
2 3 4
5
8 6 3 10 1
7 9 5 2 4
</code></pre>
<p>Output</p>
<pre><code>6
2
3
</code></pre>
<hr />
<h3 id="è§£é¢˜æ€è·¯-1"><a class="header" href="#è§£é¢˜æ€è·¯-1">è§£é¢˜æ€è·¯</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
